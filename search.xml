<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>配置 Content Security Policy</title>
    <url>/2023/01/10/configure-csp/</url>
    <content><![CDATA[<p>该配置可以在一定程度上防止 XSS 攻击，在 Nginx 中可以直接通过添加 header 实现。</p>
<pre><code class="nginx">add_header Content-Security-Policy &quot;default-src &#39;self&#39; server_names *.jovialchap.com www.google-analytics.com www.googletagmanager.com *.w.org wp-themes.com secure.gravatar.com &#39;unsafe-inline&#39; &#39;unsafe-eval&#39; blob: data: ;&quot;;
</code></pre>
<p>在其中</p>
<ul>
<li><kbd>default-src 'self'</kbd>  定义了默认规则，即只允许本站的内容</li>
<li><kbd>server_names</kbd> 和后面添加的域名表示允许从这些域名来的内容</li>
<li><kbd>'unsafe-inline'</kbd> 允许了内链js脚本的使用</li>
<li><kbd>'unsafe-eval'</kbd> 允许了js使用eval</li>
</ul>
<p>更多的查看以下的链接</p>
<ul>
<li><a href="https://imququ.com/post/my-nginx-conf-for-security.html#toc-2">本博客 Nginx 配置之安全篇 | JerryQu 的小站</a></li>
<li><a href="https://www.ruanyifeng.com/blog/2016/09/csp.html">Content Security Policy 入门教程 - 阮一峰的网络日志</a></li>
</ul>
]]></content>
      <tags>
        <tag>nginx</tag>
        <tag>网站配置</tag>
      </tags>
  </entry>
  <entry>
    <title>Nginx referer 配置例子</title>
    <url>/2023/01/10/nginx-referer-policy-example/</url>
    <content><![CDATA[<p>网站需要配置防盗链，通过 Nginx 过滤非法的 referer</p>
<pre><code class="nginx">location ~ .*\.(png|jpg|...)$ &#123;
    valid_referers none blocked server_names [domains];
    if ($invalid_referer) &#123;
        return 403;
    &#125;
&#125;
</code></pre>
<p>一些说明：</p>
<ul>
<li><kbd>server_names</kbd> 代表当前 server 块中的所有 server_name</li>
<li><kbd>domains</kbd> 可以使用泛域名</li>
</ul>
]]></content>
      <tags>
        <tag>nginx</tag>
        <tag>网站配置</tag>
      </tags>
  </entry>
</search>
